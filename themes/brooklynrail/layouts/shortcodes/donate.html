{{/*
Donate Shortcode
{{< donate placeholder="25" value="25" >}}
*/}}

{{/* Gets the `media` data from the image shortcode */}}
{{- $heading := (.Get "heading" | markdownify) -}}
{{- $placeholder := (.Get "placeholder") -}}
{{- $value := (.Get "value") -}}

<div class="shortcode-donate shortcode-donate-sm">

  <form class="rail-form" id="donate-form">
    <fieldset>
      <div class="fields">
        {{- if $heading -}}
          <legend>{{- $heading -}}</legend>
        {{- else -}}
          <legend class="hidden">Donate to the Rail</legend>
        {{- end -}}

        <div class="group">
          <div class="field">
            <label for="donate-amount">Amount</label>
            <div class="prefix">
              <span>$</span>
              <input type="number" min="0" placeholder="{{- if $placeholder -}}{{- $placeholder -}}{{- else -}}25{{- end -}}" id="donate-amount" />
            </div>
          </div>
        </div>
        <div class="group hidden">
          <div class="field">
            <label for="donate-type">Tell us which projects inspired you to donate</label>
            {{- $donation_types := $.Site.Data.donation_types -}}
            {{- range $donation_types -}}
              <div class="usa-checkbox">
                <input class="usa-checkbox__input" id="check-{{- .id -}}" type="checkbox" name="donation_types" value="{{- .id -}}">
                <label class="usa-checkbox__label" for="check-{{- .id -}}">{{- .type -}}</label>
              </div>
            {{- end -}}
          </div>
        </div>
        <div class="group">
          <div class="field">
            <button class="btn btn-md" type="button" id="btn-donate"><span>Donate</span></button>
          </div>
        </div>

      </div>
    </fieldset>
  </form>
  <p>The Brooklyn Rail is a nonprofit 501(c)(3) organization. Your donation is fully deductible. Questions? Email <a href="mailto:hq@brooklynrail.org" title="email the Brooklyn Rail">hq@brooklynrail.org</a></p>
</div>

{{- define "custom_js" }}
  <script src="https://js.stripe.com/v3/"></script>

  {{ $donate_js := (resources.Get "js/donate.js" | js.Build "material/dist/donate.js" | resources.Fingerprint "sha512") -}}
  <script src="{{- $donate_js.RelPermalink -}}" {{ printf "integrity=%q" $donate_js.Data.Integrity | safeHTMLAttr }} ></script>
  {{/* <script src="{{- "material/dist/signup.js" | relURL -}}"></script> */}}
{{- end -}}
