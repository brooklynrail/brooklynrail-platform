# Netlify File-based configuration
# Learn more at https://docs.netlify.com/configure-builds/file-based-configuration/#sample-file

# Settings in the [build] context are global and are applied to all contexts
# unless otherwise overridden by more specific contexts.

[build]
  # Directory to change to before starting a build.
  # This is where we will look for package.json/.nvmrc/etc.
  base = ""

  # Directory (relative to root of your repo) that contains the deploy-ready
  # HTML files and assets generated by the build. If a base directory has
  # been specified, include it in the publish directory path.
  publish = "public"

  # Default build command.
  command = "hugo --gc --minify -b $URL"

  # Directory with the serverless Lambda functions to deploy to AWS.
  functions = "themes/brooklynrail/static/netlify_functions"



# Production variables
[context.production.environment]
  HUGO_VERSION = "0.95.0"
  HUGO_ENV = "production"
  HUGO_ENABLEGITINFO = "true"
  URL = "https://brooklynrail.org"
  NODE_VERSION = "14.17.0"

[context.split1]
command = "hugo --gc --minify --enableGitInfo"

[context.split1.environment]
HUGO_VERSION = "0.95.0"
HUGO_ENV = "production"
NODE_VERSION = "14.17.0"

[context.deploy-preview]
command = "hugo --gc --minify --buildFuture -b $DEPLOY_URL"

[context.deploy-preview.environment]
HUGO_VERSION = "0.95.0"
NODE_VERSION = "14.17.0"

[context.branch-deploy]
command = "hugo --gc --minify -b $DEPLOY_URL"

[context.branch-deploy.environment]
HUGO_VERSION = "0.95.0"
NODE_VERSION = "14.17.0"

[context.next.environment]
HUGO_ENABLEGITINFO = "true"

[[headers]]
  for = "/*"
    [headers.values]
    Access-Control-Allow-Origin = "https://brooklynrail.org"

# Netlify DEV
[dev]
  framework = "#custom"
  command = "npm start" # Command to start your dev server
  targetPort = 1313 # port where the application will be available
  port = 8888 # The port that the netlify dev will be accessible on

[[redirects]]
  from = "/*"
  to = "/404.html"
  status = 404
  force = true

  
  